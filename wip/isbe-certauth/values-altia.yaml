# Values override for Altia environment
# Domain: *.altia.eudistack.net
# Certificate ARN: arn:aws:acm:eu-west-1:147108726325:certificate/c08fad25-729a-40da-9978-1024fc277037

# Application Configuration
replicaCount: 2

# Service URLs Configuration
serviceUrls:
  certauth: "https://certauth.altia.eudistack.net"
  certsec: "https://certsec.altia.eudistack.net"
  onboard: "https://onboard.altia.eudistack.net"

# Credentials Configuration (update these with actual values)
adminPassword:
  value: "change-me-in-production"

tsaCredentials:
  user: "tsa-user"
  password: "change-me-in-production"

smtpCredentials:
  username: "smtp-user"
  password: "change-me-in-production"

# Persistence Configuration
persistence:
  enabled: true
  storageClass: "gp3"
  size: 10Gi

# External Exposure Configuration (Ingress/ALB)
ingress:
  # CertAuth service ingress (standard HTTPS)
  certauth:
    enabled: true
    hostname: "certauth.altia.eudistack.net"
    className: "alb"
    annotations:
      alb.ingress.kubernetes.io/scheme: "internet-facing"
      alb.ingress.kubernetes.io/target-type: "ip"
      alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS": 443}]'
      alb.ingress.kubernetes.io/ssl-redirect: '443'
      alb.ingress.kubernetes.io/certificate-arn: "arn:aws:acm:eu-west-1:147108726325:certificate/c08fad25-729a-40da-9978-1024fc277037"
      alb.ingress.kubernetes.io/healthcheck-path: "/health"
      alb.ingress.kubernetes.io/healthcheck-port: "8010"
      alb.ingress.kubernetes.io/healthcheck-protocol: "HTTP"
  
  # CertSec service ingress (mTLS with passthrough)
  certsec:
    enabled: true
    hostname: "certsec.altia.eudistack.net"
    className: "alb"
    annotations:
      alb.ingress.kubernetes.io/scheme: "internet-facing"
      alb.ingress.kubernetes.io/target-type: "ip"
      alb.ingress.kubernetes.io/listen-ports: '[{"HTTPS": 443}]'
      alb.ingress.kubernetes.io/certificate-arn: "arn:aws:acm:eu-west-1:147108726325:certificate/c08fad25-729a-40da-9978-1024fc277037"
      # Enable mTLS in passthrough mode - client certificate passed to backend
      alb.ingress.kubernetes.io/mutual-authentication: '[{"port": 443, "mode": "passthrough"}]'
      # Backend protocol must be HTTPS for mTLS passthrough
      alb.ingress.kubernetes.io/backend-protocol: "HTTPS"
      alb.ingress.kubernetes.io/healthcheck-path: "/health"
      alb.ingress.kubernetes.io/healthcheck-port: "8010"
      alb.ingress.kubernetes.io/healthcheck-protocol: "HTTP"
  
  # Onboard service ingress (standard HTTPS)
  onboard:
    enabled: true
    hostname: "onboard.altia.eudistack.net"
    className: "alb"
    annotations:
      alb.ingress.kubernetes.io/scheme: "internet-facing"
      alb.ingress.kubernetes.io/target-type: "ip"
      alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS": 443}]'
      alb.ingress.kubernetes.io/ssl-redirect: '443'
      alb.ingress.kubernetes.io/certificate-arn: "arn:aws:acm:eu-west-1:147108726325:certificate/c08fad25-729a-40da-9978-1024fc277037"
      alb.ingress.kubernetes.io/healthcheck-path: "/health"
      alb.ingress.kubernetes.io/healthcheck-port: "8010"
      alb.ingress.kubernetes.io/healthcheck-protocol: "HTTP"

# Resource Configuration (optimized for cost-effective t3a.small nodes)
resources:
  limits:
    cpu: 400m
    memory: 512Mi
  requests:
    cpu: 200m
    memory: 256Mi

# Observability Configuration (disabled - CRDs not installed)
observability:
  enabled: false
  scrapePath: /metrics
  dashboard:
    enabled: false
